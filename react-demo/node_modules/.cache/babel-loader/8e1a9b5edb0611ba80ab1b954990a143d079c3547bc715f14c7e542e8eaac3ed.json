{"ast":null,"code":"import _toConsumableArray from \"/home/ioana/Desktop/Energy Management System/react-demo/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/home/ioana/Desktop/Energy Management System/react-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/home/ioana/Desktop/Energy Management System/react-demo/src/client/user-notifications.js\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport SockJsClient from 'react-stomp';\nimport './user-notifications.css';\nvar SOCKET_URL = 'http://localhost:8281/websocket';\nvar UserNotifications = function UserNotifications() {\n  _s();\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    notifications = _useState2[0],\n    setNotifications = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userId = _useState4[0],\n    setUserId = _useState4[1];\n  useEffect(function () {\n    getLoggedInUsername();\n  }, []);\n  var getLoggedInUsername = function getLoggedInUsername() {\n    fetch('http://localhost:8080/auth/username', {\n      method: 'GET',\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      }\n    }).then(function (response) {\n      return response.text();\n    }).then(function (username) {\n      console.info(\"Logged-in Username: \" + username);\n      getUserIdFromUsername(username);\n    }).catch(function (error) {\n      console.error('Error fetching logged-in username:', error);\n    });\n  };\n  var getUserIdFromUsername = function getUserIdFromUsername(username) {\n    fetch(\"http://localhost:8080/user/id?username=\".concat(username), {\n      method: 'GET',\n      headers: {\n        'Authorization': 'Bearer ' + localStorage.getItem('token')\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      setUserId(data); // Set the userId state\n    }).catch(function (error) {\n      console.error('Error fetching userId:', error);\n    });\n  };\n  var topic = userId ? \"/topic/message/\".concat(userId) : '';\n  var onConnected = function onConnected() {\n    console.log('Connected!!');\n  };\n  var onMessageReceived = function onMessageReceived(msg) {\n    setNotifications(function (prevNotifications) {\n      return [].concat(_toConsumableArray(prevNotifications), [msg.message]);\n    });\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }\n  }, userId && /*#__PURE__*/React.createElement(SockJsClient, {\n    url: SOCKET_URL,\n    topics: [topic],\n    onConnect: onConnected,\n    onDisconnect: function onDisconnect() {\n      return console.log('Disconnected!');\n    },\n    onMessage: function onMessage(msg) {\n      return onMessageReceived(msg);\n    },\n    debug: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"notifications\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }\n  }, \"New notifications:\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, notifications.map(function (notification, index) {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 25\n      }\n    }, notification);\n  }))));\n};\n_s(UserNotifications, \"0TmytXdPf8v7ZZUM2m7xZOtVoCQ=\");\n_c = UserNotifications;\nexport default UserNotifications;\nvar _c;\n$RefreshReg$(_c, \"UserNotifications\");","map":{"version":3,"names":["React","useState","useEffect","SockJsClient","SOCKET_URL","UserNotifications","_s","_useState","_useState2","_slicedToArray","notifications","setNotifications","_useState3","_useState4","userId","setUserId","getLoggedInUsername","fetch","method","headers","localStorage","getItem","then","response","text","username","console","info","getUserIdFromUsername","catch","error","concat","json","data","topic","onConnected","log","onMessageReceived","msg","prevNotifications","_toConsumableArray","message","createElement","className","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber","url","topics","onConnect","onDisconnect","onMessage","debug","map","notification","index","key","_c","$RefreshReg$"],"sources":["/home/ioana/Desktop/Energy Management System/react-demo/src/client/user-notifications.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport SockJsClient from 'react-stomp';\nimport './user-notifications.css';\n\nconst SOCKET_URL = 'http://localhost:8281/websocket';\n\nconst UserNotifications = () => {\n    const [notifications, setNotifications] = useState([]);\n    const [userId, setUserId] = useState('');\n\n    useEffect(() => {\n        getLoggedInUsername();\n    }, []);\n\n    const getLoggedInUsername = () => {\n        fetch('http://localhost:8080/auth/username', {\n            method: 'GET',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n        })\n            .then((response) => response.text())\n            .then((username) => {\n                console.info(\"Logged-in Username: \" + username);\n                getUserIdFromUsername(username);\n            })\n            .catch((error) => {\n                console.error('Error fetching logged-in username:', error);\n            });\n    };\n\n    const getUserIdFromUsername = (username) => {\n        fetch(`http://localhost:8080/user/id?username=${username}`, {\n            method: 'GET',\n            headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('token'),\n            },\n        })\n            .then((response) => response.json())\n            .then((data) => {\n                setUserId(data); // Set the userId state\n            })\n            .catch((error) => {\n                console.error('Error fetching userId:', error);\n            });\n    };\n\n    const topic = userId ? `/topic/message/${userId}` : '';\n\n    const onConnected = () => {\n        console.log('Connected!!');\n    };\n\n    const onMessageReceived = (msg) => {\n        setNotifications(prevNotifications => [...prevNotifications, msg.message]);\n    };\n\n    return (\n        <div className=\"container\">\n            {userId && (\n                <SockJsClient\n                    url={SOCKET_URL}\n                    topics={[topic]}\n                    onConnect={onConnected}\n                    onDisconnect={() => console.log('Disconnected!')}\n                    onMessage={(msg) => onMessageReceived(msg)}\n                    debug={false}\n                />\n            )}\n            <div className=\"notifications\">\n                <h3>New notifications:</h3>\n                <ul>\n                    {notifications.map((notification, index) => (\n                        <li key={index}>{notification}</li>\n                    ))}\n                </ul>\n            </div>\n        </div>\n    );\n};\n\nexport default UserNotifications;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
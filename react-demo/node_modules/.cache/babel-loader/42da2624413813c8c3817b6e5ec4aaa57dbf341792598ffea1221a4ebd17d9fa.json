{"ast":null,"code":"import _toConsumableArray from \"/home/ioana/Desktop/Energy Management System/react-demo/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/home/ioana/Desktop/Energy Management System/react-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/home/ioana/Desktop/Energy Management System/react-demo/src/client/chat.js\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport SockJsClient from 'react-stomp';\nvar ChatWindow = function ChatWindow(_ref) {\n  _s();\n  var isOpen = _ref.isOpen,\n    onClose = _ref.onClose;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    message = _useState2[0],\n    setMessage = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    selectedUser = _useState4[0],\n    setSelectedUser = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    users = _useState6[0],\n    setUsers = _useState6[1];\n  var _useState7 = useState([]),\n    _useState8 = _slicedToArray(_useState7, 2),\n    messages = _useState8[0],\n    setMessages = _useState8[1];\n  var clientRef = useRef(null);\n  var handleMessage = function handleMessage(msg) {\n    setMessages([].concat(_toConsumableArray(messages), [msg]));\n  };\n  useEffect(function () {\n    // Fetch users from your backend and set them in the state\n    // Replace 'fetchUsers' with your API call to get users\n    fetchUsers().then(function (usersData) {\n      setUsers(usersData);\n    });\n  }, []);\n  var handleSendMessage = function handleSendMessage() {\n    if (selectedUser && message.trim() !== '' && clientRef.current && clientRef.current.sendMessage) {\n      clientRef.current.sendMessage(\"/app/chat/\".concat(selectedUser), {\n        text: message,\n        sender: 'CurrentLoggedInUser',\n        // Replace with the logged-in user\n        messageType: 'TEXT' // Adjust message type if needed\n      });\n\n      setMessage('');\n    }\n  };\n  var handleKeyPress = function handleKeyPress(event) {\n    if (event.key === 'Enter') {\n      handleSendMessage();\n    }\n  };\n  return isOpen && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'fixed',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)',\n      backgroundColor: 'white',\n      padding: '20px',\n      zIndex: 999\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 17\n    }\n  }, \"Chat Window\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 17\n    }\n  }, messages.map(function (msg, index) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 29\n      }\n    }, msg.sender, \": \", msg.text));\n  })), /*#__PURE__*/React.createElement(\"select\", {\n    value: selectedUser,\n    onChange: function onChange(e) {\n      return setSelectedUser(e.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 21\n    }\n  }, \"Select a user\"), users.map(function (user) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: user.id,\n      value: user.username,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 25\n      }\n    }, user.username);\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    value: message,\n    onChange: function onChange(e) {\n      return setMessage(e.target.value);\n    },\n    onKeyPress: handleKeyPress,\n    placeholder: \"Type a message...\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }, \"Send\"), /*#__PURE__*/React.createElement(SockJsClient, {\n    url: \"http://localhost:your_backend_port/chat\" // Replace with your backend URL\n    ,\n    topics: [\"/topic/messages/\".concat(selectedUser)] // Use selected user for topic\n    ,\n    onMessage: handleMessage,\n    debug: false,\n    ref: function ref(client) {\n      return clientRef.current = client;\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 17\n    }\n  }));\n};\n_s(ChatWindow, \"HmcRGZ2tHMDcO+5F4KVODkarPLE=\");\n_c = ChatWindow;\nexport default ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useState","useEffect","useRef","SockJsClient","ChatWindow","_ref","_s","isOpen","onClose","_useState","_useState2","_slicedToArray","message","setMessage","_useState3","_useState4","selectedUser","setSelectedUser","_useState5","_useState6","users","setUsers","_useState7","_useState8","messages","setMessages","clientRef","handleMessage","msg","concat","_toConsumableArray","fetchUsers","then","usersData","handleSendMessage","trim","current","sendMessage","text","sender","messageType","handleKeyPress","event","key","createElement","style","position","top","left","transform","backgroundColor","padding","zIndex","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber","map","index","value","onChange","e","target","user","id","username","type","onKeyPress","placeholder","onClick","url","topics","onMessage","debug","ref","client","_c","$RefreshReg$"],"sources":["/home/ioana/Desktop/Energy Management System/react-demo/src/client/chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport SockJsClient from 'react-stomp';\n\nconst ChatWindow = ({ isOpen, onClose }) => {\n    const [message, setMessage] = useState('');\n    const [selectedUser, setSelectedUser] = useState('');\n    const [users, setUsers] = useState([]);\n    const [messages, setMessages] = useState([]);\n    const clientRef = useRef(null);\n\n    const handleMessage = (msg) => {\n        setMessages([...messages, msg]);\n    };\n    \n\n    useEffect(() => {\n        // Fetch users from your backend and set them in the state\n        // Replace 'fetchUsers' with your API call to get users\n        fetchUsers().then((usersData) => {\n            setUsers(usersData);\n        });\n    }, []);\n\n    const handleSendMessage = () => {\n        if (selectedUser && message.trim() !== '' && clientRef.current && clientRef.current.sendMessage) {\n            clientRef.current.sendMessage(`/app/chat/${selectedUser}`, {\n                text: message,\n                sender: 'CurrentLoggedInUser', // Replace with the logged-in user\n                messageType: 'TEXT', // Adjust message type if needed\n            });\n            setMessage('');\n        }\n    };\n\n    const handleKeyPress = (event) => {\n        if (event.key === 'Enter') {\n            handleSendMessage();\n        }\n    };\n\n    return (\n        isOpen && (\n            <div style={{ position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', backgroundColor: 'white', padding: '20px', zIndex: 999 }}>\n                <h2>Chat Window</h2>\n                <div>\n                    {messages.map((msg, index) => (\n                        <div key={index}>\n                            <p>{msg.sender}: {msg.text}</p>\n                        </div>\n                    ))}\n                </div>\n                <select value={selectedUser} onChange={(e) => setSelectedUser(e.target.value)}>\n                    <option value=\"\">Select a user</option>\n                    {users.map((user) => (\n                        <option key={user.id} value={user.username}>\n                            {user.username}\n                        </option>\n                    ))}\n                </select>\n                <input\n                    type=\"text\"\n                    value={message}\n                    onChange={(e) => setMessage(e.target.value)}\n                    onKeyPress={handleKeyPress}\n                    placeholder=\"Type a message...\"\n                />\n                <button onClick={handleSendMessage}>Send</button>\n                <SockJsClient\n                    url='http://localhost:your_backend_port/chat' // Replace with your backend URL\n                    topics={[`/topic/messages/${selectedUser}`]} // Use selected user for topic\n                    onMessage={handleMessage}\n                    debug={false}\n                    ref={(client) => (clientRef.current = client)}\n                />\n            </div>\n        )\n    );\n};\n\nexport default ChatWindow;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}